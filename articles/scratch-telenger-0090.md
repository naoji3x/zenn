---
title: "Scratchでオリジナルキャラクターを動かそう！ (9) 宿命の出会い"
emoji: "🧑‍💻"
type: "tech"
topics: ["scratch", "CoderDojo", "animation"]
published: false
---

## はじめに

[CoderDojo](https://coderdojo.jp/)というボランティア団体で、子供達のプログラミングスキル習得の支援をしております。プログラミングの開発環境は、主に[Scratch](https://scratch.mit.edu)を使っていますが、チュートリアルの次のレベルの教材を充実させたいと感じており、本シリーズの執筆を開始しました。

**いよいよゲームの完成です！** 🎉

## 宿命の出会い

[前回まで](https://zenn.dev/naoji/articles/scratch-telenger-0080)でテレッド、ハンコまわしのHPバーを追加しました。今回はオープニング、説明、効果音、BGM、エンディングなど、ゲームのメイン機能以外を一気に作成しました。本シリーズの成果物は以下になります。

### Scratchのサイト

**[宿命の出会い](https://scratch.mit.edu/projects/860791993/)**

![宿命の出会い オープニング](/images/scratch-telenger-0090/scratch-telenger-0090-fighting-1.gif)
*オープニング*

![宿命の出会い ミッション](/images/scratch-telenger-0090/scratch-telenger-0090-fighting-2.gif)
*ミッション*

![宿命の出会い ゲームクリア](/images/scratch-telenger-0090/scratch-telenger-0090-fighting-3.gif)
*ゲームクリア*

今回は新たにScratchの以下の機能を活用しています。

1. **音**: 効果音やBGMを編集するために使用しています。
2. **音を鳴らす**: 効果音を鳴らすために使用しています。
3. **音を〇ずつ変える**: ゲームクリア時、ゲームオーバー時にBGMを止めるために使用しています。

## オープニングタイトルの実装

オープニングタイトルはいつものように[Affinity Designer](https://affinity.serif.com/ja-jp/designer)で作成しました。

:::message alert
留意点ですが、タイトルのような文字をScratchに取り込む場合は、フォントのライセンスを確認しましょう。有償のフォントを使うとライセンス違反になる場合があります。私は[Rounded M+](http://jikasei.me/font/rounded-mplus/about.html)を愛用していますが、最近は無償で自由に使えるフォントも増えてきていますので、色々探してみると面白いと思います。
:::

今回、Affinity Designerから取り込んでみて、つまずいた点は以下になります;

- ScratchにRounded M+のフォントが正常に取り込まれるか、不安がありましたので、フォントを画像として取り込むことにしました。やり方は、Affinity Designer上でテキストを右クリックしてをメニューから「カーブに変換」を選ぶことで、テキストを画像に変換しています。
- Scratchにsvgを取り込む場合は、いつものようにエクスポートしたsvgファイルをテキストエディタで開き、`width="100%" height="100%"`の部分を削除してください。
- コスチュームとして取り込み後に、境界部分がおかしな表示なっている場合もありました。この場合はScratch上で多少の修正が必要です。Scratchにうまく取り込めるように、タイトルの文字の部分とアウトラインの部分を分けてレイヤー化したり、と色々工夫をしました。

タイトルは上下の行、`デジタル戦隊`と`テレんじゃー`を分けてスプライト化しています。今回は音を使いましたのでその点を説明します。

1. スプライトのタブから`音`タブを選択。
2. 左したのメニューから`音を選ぶ`を選択。
3. 好みの音を選択。
4. 音の大きさなどを好みに調整。

![音](/images/scratch-telenger-0090/sound.png)

音の名前は英語で書かれていますが、内容は再生ボタンですぐに聴けるので問題ないと思います。使いたい音が決まったらコードに反映します。今回は、オープニングの効果音として、`Teleport`を使っています。音の大きさなど、Scratch上で色々調整ができます。

次にコードを見ていきましょう。`デジタル戦隊`と`テレんじゃー`はほぼ同じコードのため、`テレんじゃー`側だけコードをみていきます。`〇の音を鳴らす`を今回初めて使いましたが、その他は難しいことはやっていません。

1. `の音を鳴らす`で`Teleport`の音を鳴らして、音の終了を待たずに次の処理に移っています。
2. 最初にピクセル化を`256`にして、ループでピクセルかを0に戻しています。
3. タイトルを縮小して最後に隠しています。

![音](/images/scratch-telenger-0090/telenger-title.png)

## ゲーム進行の実装

ゲームの遊び方とゲームのミッションの説明表示を`ゲーム進行`スプライトで実装しています。文章の見栄えはそこそこでいいので、今回はScratch上で作成しました。それではコードを見ていきましょう。

1. タイトル表示後のタイミングで`説明`を表示。
2. 説明では上左右矢印キー、スペースキーを押してもらうように促していますので、全部押されたかをメッセージで確認しています。
3. 全部押されたかは、`条件が揃ったらミッションへ`ブロック定義で確認して、条件が揃った場合に、
4. ミッション表示に移行して、BGMを開始するメッセージを送信し、その後、ミッションを非表示化してハンコまわしを表示しています。
5. BGMはループ再生していますが、ゲームクリア・ゲームオーバー時に音量を０にすることで停止しています。

![ゲーム進行](/images/scratch-telenger-0090/explanation.png)

## ゲームクリア・ゲームオーバーの実装

ゲームクリアもしくはゲームオーバーの表示を`ゲーム終了`スプライトで実装しています。このコードは今まで学んできた内容の繰り返しになりますので説明は割愛します。

## 諸々の効果音の実装

`テレッド`、`ハンコまわし`、`竜巻`、`デジタルフラッシュ`のコードに効果音やメッセージ送信を追加しています。難しいことはやっていませんので、詳細は実際のコードを確認下さい。

## おわりに

ようやくゲームとして完成しました！本シリーズはここで終了ですが、一つの作品として最後まで作り切るのは根気が必要ですね！皆様も是非、小さなもので構いませんので、最後まで作り切って[Scratch](https://scratch.mit.edu/)のサイトに公開してみましょう。

本シリーズを最後までお読みいただき、ありがとうございました！

## Scratchでオリジナルキャラクターを動かそう！ インデックス

[(1) テレんじゃー大地に立つ！（アニメーション）](https://zenn.dev/naoji/articles/scratch-telenger-0010)
[(2) こいつ動くぞ！（キーボードで動かす）](https://zenn.dev/naoji/articles/scratch-telenger-0020)
[(3) 翔べ！テレんじゃー（ジャンプ）](https://zenn.dev/naoji/articles/scratch-telenger-0030)
[(4) 戦場はオフィス（背景を動かす）](https://zenn.dev/naoji/articles/scratch-telenger-0040)
[(5) ハンコの脅威（敵キャラを動かす）](https://zenn.dev/naoji/articles/scratch-telenger-0050)
[(6) 死闘！デジタル・フラッシュ（ビーム発射）](https://zenn.dev/naoji/articles/scratch-telenger-0060)
[(7) オフィスの激戦（当たり判定）](https://zenn.dev/naoji/articles/scratch-telenger-0070)
[(8) ハンコまわし 散る（HPバー）](https://zenn.dev/naoji/articles/scratch-telenger-0080)
(9) 宿命の出会い（完成！）
