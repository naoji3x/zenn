---
title: "Scratchã‚’æ‹¡å¼µã—ã‚ˆã†ï¼(1)å¤©æ°—äºˆå ±ã‚’å–å¾—"
emoji: "ğŸ˜¾"
type: "tech"
topics: ["scratch", "CoderDojo", "javascript"]
published: true
---

## ã¯ã˜ã‚ã«

[CoderDojo](https://coderdojo.jp/)ã¨ã„ã†ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢å›£ä½“ã§ã€å­ä¾›é”ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚¹ã‚­ãƒ«ç¿’å¾—ã®æ”¯æ´ã‚’ã—ã¦ãŠã‚Šã¾ã™ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®é–‹ç™ºç’°å¢ƒã¯ã€ä¸»ã«[Scratch]((https://scratch.mit.edu))ã‚’ä½¿ã£ã¦ã„ã¾ã™ãŒã€æ¨™æº–æ©Ÿèƒ½ã ã‘ã§ã¯é£½ãè¶³ã‚‰ãšã€ã“ã®ã‚·ãƒªãƒ¼ã‚ºã§ã¯Scratchã®æ‹¡å¼µæ©Ÿèƒ½é–‹ç™ºã«æŒ‘æˆ¦ã—ã¾ã™ï¼

å®Œæˆã—ãŸã‚µã‚¤ãƒˆã¯ã“ã¡ã‚‰ã«ãªã‚Šã¾ã™ã€‚

**[å¤©æ°—äºˆå ±æ‹¡å¼µæ©Ÿèƒ½ä»˜ãScratch](https://naoji3x.github.io/scratch-gui/)**

![å¤©æ°—äºˆå ±æ‹¡å¼µæ©Ÿèƒ½ä»˜ãScratch](/images/scratch-extension-0010/extension.png)
*ãƒ©ãƒ¼ã‚¸ã‚µã‚¤ã‚º 600px x 372px*

æ‹¡å¼µæ©Ÿèƒ½ã‹ã‚‰å¤©æ°—äºˆå ±ã‚’è¿½åŠ ã™ã‚‹ã¨ã€

- ç¾åœ¨åœ°ã®å¤©æ°—äºˆå ±ã€ã‚‚ã—ãã¯ã€éƒ½é“åºœçœŒåˆ¥ã®å¤©æ°—äºˆå ±ã‚’å–å¾—ã™ã‚‹ãƒ–ãƒ­ãƒƒã‚¯ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
- ï¼‘é€±é–“åˆ†ã®å¤©æ°—äºˆå ±ã‚’ãƒªã‚¹ãƒˆã«æ ¼ç´ã™ã‚‹æ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚

:::message alert
**ä¸€é€±é–“åˆ†ã®å¤©æ°—äºˆå ±ã‚’æ ¼ç´ã™ã‚‹ãƒªã‚¹ãƒˆã§ã™ãŒã€ãƒªã‚¹ãƒˆåæ¬„ã«ã¯ãƒªã‚¹ãƒˆã‚’ãƒ‰ãƒ©ãƒƒã‚¯ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ã®ã§ã¯ãªãã€ãƒªã‚¹ãƒˆã®åå‰ã‚’æ›¸ãè¾¼ã‚“ã§ä¸‹ã•ã„**ã€‚
:::

## Scratchã®æ‹¡å¼µæ©Ÿèƒ½é–‹ç™º

Scratchã®æ‹¡å¼µæ©Ÿèƒ½ã®é–‹ç™ºã¯[Scratch Japan Wiki](https://ja.scratch-wiki.info/wiki/Scratch_3.0%E3%81%AE%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86)ã‚„[ã‚¿ã‚³ã‚­ãƒ³ã®Pã‚¹ã‚¯ãƒ¼ãƒ«ãƒ»ãƒ–ãƒ­ã‚°](https://p-school.tacoskingdom.com/developer#blog)ã«ä¸å¯§ã«è§£èª¬ã•ã‚Œã¦ã„ã¾ã™ãŒã€è‰²ã€…ã¤ã¾ã¥ããƒã‚¤ãƒ³ãƒˆã‚‚ã‚ã‚Šã¾ã—ãŸã®ã§å‚™å¿˜ã‚‚å«ã‚ã¾ã¨ã‚ã¾ã™ã€‚ä»Šå›ã¯ã€æ°—è»½ã«å¤©æ°—äºˆå ±ãŒå–å¾—ã§ãã‚‹[Open Meteo](https://open-meteo.com)ã‹ã‚‰æƒ…å ±ã‚’å–å¾—ã—ã¦ã€Scratchã§è¡¨ç¤ºã™ã‚‹æ‹¡å¼µæ©Ÿèƒ½ã‚’ä½œæˆã—ã¾ã™ã€‚

https://open-meteo.com

### ä¸‹æº–å‚™

ã¾ãšã¯ã€scratchæœ¬å®¶ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’è‡ªåˆ†ã®ãƒªãƒã‚¸ãƒˆãƒªã«ãƒ•ã‚©ãƒ¼ã‚¯ã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ä»¥ä¸‹ã€ï¼’ã¤ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯ã—ã¾ã™ã€‚ãƒ•ã‚©ãƒ¼ã‚¯ã¯Githubä¸Šã§ãƒªãƒã‚¸ãƒˆãƒªã‚’è‡ªåˆ†ç”¨ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹æ©Ÿèƒ½ã§ã€è©³ç´°ã¯[ã“ã¡ã‚‰](https://docs.github.com/ja/get-started/quickstart/fork-a-repo)ã‚’å‚ç…§ãã ã•ã„ã€‚

| ãƒªãƒã‚¸ãƒˆãƒª | å†…å®¹ |
| --- | --- |
| https://github.com/LLK/scratch-vm | ã‚¹ã‚¯ãƒ©ãƒƒãƒã®å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³ |
| https://github.com/LLK/scratch-gui | ã‚¹ã‚¯ãƒ©ãƒƒãƒã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒªãƒã‚¸ãƒˆãƒª |

æ¬¡ã«ã€ãƒ•ã‚©ãƒ¼ã‚¯ã—ãŸãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦é–‹ç™ºç’°å¢ƒã‚’æ•´ãˆã¾ã™ã€‚
```bash
git clone --depth 1 https://github.com/[GitHubã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ]/scratch-vm.git # 1
git clone --depth 1 https://github.com/[GitHubã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ]/scratch-gui.git # 2
cd scratch-vm # 3
npm i # 4
npm run build # 5
npm link # 6
cd ../scratch-gui # 7
npm i # 8
npm link scratch-vm # 9
npm start # 10
```

ä»¥ä¸‹ã«å„ã€…ã®ã‚³ãƒãƒ³ãƒ‰ã®æ„å‘³ã‚’èª¬æ˜ã—ã¾ã™ï¼›

1. scratch-vmã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¾ã™ã€‚--depth 1ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ–ãƒ©ãƒ³ãƒã®æœ€å¾Œã®ã‚³ãƒŸãƒƒãƒˆã®ã¿ã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã€éå»ã®å±¥æ­´ãŒå¿…è¦ãªã„å ´åˆã«æŒ‡å®šã—ã¾ã™ï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å®¹é‡ãŒå‰Šæ¸›ã•ã‚Œã‚‹ãŸã‚é«˜é€ŸåŒ–ã«å¯„ä¸ã—ã¾ã™ï¼‰ã€‚`[GitHubã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ]`ã«ã¯å€‹äººã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚httpsã§ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹å ´åˆã¯`https://github.com/[GitHubã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ]/scratch-vm.git`ã§ã™ãŒã€SSHã®å ´åˆã¯`git@github.com:[GitHubã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ]/scratch-vm.git`ã§ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ä¸‹ã•ã„ã€‚
2. scratch-guiã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¾ã™ã€‚è©³ç´°ã¯1ã¨åŒæ§˜ã§ã™ã€‚
3. scratch-vmãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã¾ã™ã€‚
4. `npm i`ã¯`npm install`ã®çœç•¥å½¢ã§ã€scratch-vmã«å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
5. scratch-vmã®å®Ÿè¡Œç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚â€»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®è¨˜äº‹ã§ã¯ã“ã®ã‚³ãƒãƒ³ãƒ‰ãŒçœç•¥ã•ã‚Œã¦ã„ã¾ã™ãŒã€ä»Šå›ã€ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãªã„ã¨ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚
6. `npm link`ã§scratch-vmã®ç’°å¢ƒã‚’ãƒ­ãƒ¼ã‚«ãƒ«PCå†…ã®ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å‚ç…§ã§ãã‚‹ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚å¾Œã»ã©ã€scratch-guiã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ã“ã®ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚’å‚ç…§ã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚
7. scratch-guiãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã¾ã™ã€‚
8. scratch-guiã«å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
9. `link scratch-vm`ã§ä»Šå›ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸscratch-vmã‚’å‚ç…§ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã“ã®è¨­å®šã‚’ã—ãªã„ã¨ã€ãƒ­ãƒ¼ã‚«ãƒ«ã®scratch-vmã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ãŒscratch-guiå´ã«åæ˜ ã•ã‚Œã¾ã›ã‚“ã€‚
10. ãƒ­ãƒ¼ã‚«ãƒ«ã§Web Serverã‚’ç«‹ã¡ä¸Šã’ã¦ã€scratchã‚’ãƒ†ã‚¹ãƒˆã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

ä¸Šè¨˜å¾Œã€`http://localhost:8601`ã«ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ãŠé¦´æŸ“ã¿ã®Scratchã®ç·¨é›†ç”»é¢ãŒç«‹ã¡ä¸ŠãŒã‚Šã¾ã™ã€‚

### scratch-guiå´ã®é–‹ç™º

`scratch-gui/src/lib/libraries/extensions`ã«`openmeteo`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œã‚Šã¾ã—ã‚‡ã†ã€‚ã“ã®ä¸­ã«Scratchã®æ‹¡å¼µæ©Ÿèƒ½ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’æ ¼ç´ã—ã¾ã™ã€‚ãƒ©ãƒ¼ã‚¸ã‚µã‚¤ã‚ºã®ã‚¢ã‚¤ã‚³ãƒ³ã¯600px x 372px, ã‚¹ãƒ¢ãƒ¼ãƒ«ã‚µã‚¤ã‚ºã®ã‚¢ã‚¤ã‚³ãƒ³ã¯80px x 80pxã«ãªã‚Šã¾ã™ã€‚

![ãƒ©ãƒ¼ã‚¸ã‚µã‚¤ã‚º](/images/scratch-extension-0010/open-meteo.png)
*ãƒ©ãƒ¼ã‚¸ã‚µã‚¤ã‚º 600px x 372px*

![ã‚¹ãƒ¢ãƒ¼ãƒ«ã‚µã‚¤ã‚º](/images/scratch-extension-0010/open-meteo-small.png)
*ã‚¹ãƒ¢ãƒ¼ãƒ«ã‚µã‚¤ã‚º 80px x 80px*

ã“ã®å¾Œã¯ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ä¿®æ­£ã«ãªã‚Šã¾ã™ã€‚`scratch-gui/src/lib/libraries/extensions/index.jsx`ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```javascript
...ä¸­ç•¥

import gdxforInsetIconURL from './gdxfor/gdxfor-small.svg';
import gdxforConnectionIconURL from './gdxfor/gdxfor-illustration.svg';
import gdxforConnectionSmallIconURL from './gdxfor/gdxfor-small.svg';

import openMeteoIconURL from './openmeteo/open-meteo.png'; // ã“ã®è¡Œã‚’è¿½åŠ 
import openMeteoInsetIconURL from './openmeteo/open-meteo-small.png'; // ã“ã®è¡Œã‚’è¿½åŠ 

...ä¸­ç•¥

       connectingMessage: (
            <FormattedMessage
                defaultMessage="Connecting"
                description="Message to help people connect to their force and acceleration sensor."
                id="gui.extension.gdxfor.connectingMessage"
            />
        ),
        helpLink: 'https://scratch.mit.edu/vernier'
    },
    // æœ€å¾Œã«ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ 
    {
        name: 'å¤©æ°—äºˆå ±(ã¦ã‚“ãã‚ˆã»ã†)',
        extensionId: 'openMeteo',
        iconURL: openMeteoIconURL,
        insetIconURL: openMeteoInsetIconURL,
        description: 'å¤©æ°—äºˆå ±ã‚’å–å¾—ã—ã¾ã™ï¼ˆã¦ã‚“ãã‚ˆã»ã†ã‚’ã—ã‚…ã¨ãã—ã¾ã™ï¼‰',
        internetConnectionRequired: true,
        featured: true
    }
    // ã“ã“ã¾ã§
];
```

`index.jsx`ã«ã¯`æ‹¡å¼µæ©Ÿèƒ½ã‚’é¸ã¶ã®ç”»é¢`ã§è¡¨ç¤ºã™ã‚‹å†…å®¹ã‚’è¨­å®šã—ã¾ã™ã€‚`openmeteo`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã—ãŸç”»åƒã®URLã¨ãã®ä»–å„ç¨®è¡¨ç¤ºæƒ…å ±ã‚’è¨­å®šã—ã¾ã™ã€‚æœ¬å½“ã¯ã€å¤šè¨€èªå¯¾å¿œã€ã²ã‚‰ãŒãªè¡¨ç¤ºå¯¾å¿œã¾ã§è¨­å®šã—ãŸã‹ã£ãŸã®ã§ã™ãŒã€è‰²ã€…å¤§å¤‰ãã†ãªãŸã‚ä»Šå›ã¯æ—¥æœ¬èªè¡¨ç¤ºã®ã¿ã«ã—ã¦ã„ã¾ã™ã€‚

### scratch-vmå´ã®é–‹ç™º

æ¬¡ã«æ‹¡å¼µæ©Ÿèƒ½ã®ãƒ­ã‚¸ãƒƒã‚¯æœ¬ä½“ã‚’é–‹ç™ºã—ã¾ã™ã€‚ã“ã¡ã‚‰ã¯scratch-vmå´ã‚’æ”¹é€ ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

å…ˆãšã¯scratchã®é–‹ç™ºã§async/awaitãŒä½¿ãˆã‚‹ã‚ˆã†ã«ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã¾ã™ï¼ˆ[ã“ã¡ã‚‰](https://p-school.tacoskingdom.com/blog/65)ã‚’å‚è€ƒã«ã—ã¾ã—ãŸï¼‰ã€‚ã“ã®è¨­å®šã¯å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ã‚³ãƒ¼ãƒ‰ã®è¦‹é€šã—ãŒè‰¯ããªã‚‹ã®ã§ã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ã€‚ä»¥ä¸‹ã€async/awaitãŒä½¿ãˆã‚‹å‰æã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ã¦ã„ã¾ã™ã€‚

```bash
cd ../scratch-vm
npm i @babel/runtime @babel/plugin-transform-runtime -D
```

`src/virtual-machine.js`ã«ã®å…ˆé ­ã«ä»¥ä¸‹ã‚’è¿½åŠ ã™ã‚‹ã¨async/awaitãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```js
require('core-js');
require('regenerator-runtime/runtime');
```

æ¬¡ã«æ‹¡å¼µæ©Ÿèƒ½ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’æº–å‚™ã—ã¾ã™ã€‚ã‚µã‚¤ã‚ºã¯40px x 40pxã§ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”¨ã¨ãƒ–ãƒ­ãƒƒã‚¯ç”¨ã®ï¼’ã¤ã‚’æº–å‚™ã—ã¾ã™ã€‚

![ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³](/images/scratch-extension-0010/icons.png)
*ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã€ãƒ–ãƒ­ãƒƒã‚¯ã‚¢ã‚¤ã‚³ãƒ³*

ä¸Šè¨˜ã®ã‚¢ã‚¤ã‚³ãƒ³ã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«åŸ‹ã‚è¾¼ã¿ã¾ã™ã®ã§ã€[ã“ã¡ã‚‰ã®ã‚µã‚¤ãƒˆ](https://lab.syncer.jp/Tool/Base64-encode/)ç­‰ã§base64ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦ä¸‹ã•ã„ï¼ˆã“ã®ã‚ãŸã‚Šã‚‚[ã‚¿ã‚³ã‚­ãƒ³ã®Pã‚¹ã‚¯ãƒ¼ãƒ«ãƒ»ãƒ–ãƒ­ã‚°](https://p-school.tacoskingdom.com/blog/39)ã«è©³ã—ãè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ï¼‰ã€‚

ã„ã‚ˆã„ã‚ˆæ‹¡å¼µæ©Ÿèƒ½ã®é–‹ç™ºã§ã™ã€‚`src/extensions`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«open_meteoãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ ¼ç´ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ãã ã•ã„ã€‚

#### index.js

æ‹¡å¼µæ©Ÿèƒ½ã®ãƒ¡ã‚¤ãƒ³å‡¦ç†ãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã¨ã—ã¦å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚blockIconURI, menuIconURIã«ã¯base64ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ãŸã‚¢ã‚¤ã‚³ãƒ³ãŒã‚³ãƒ”ãƒšã•ã‚Œã¦ã„ã¾ã™ã€‚

- `getPrefectureWeather`ã§éƒ½é“åºœçœŒã®å¤©æ°—ã‚’å–å¾—
- `getWeather`ã§ç¾åœ¨åœ°ã®å¤©æ°—ã‚’å–å¾—
- `listPrefectureWeather`ã§éƒ½é“åºœçœŒã®ä¸€é€±é–“åˆ†ã®å¤©æ°—ã‚’å–å¾—ã—ãƒªã‚¹ãƒˆã«æ ¼ç´
- `listWether`ã§ç¾åœ¨åœ°ã®ä¸€é€±é–“åˆ†ã®å¤©æ°—ã‚’å–å¾—ã—ãƒªã‚¹ãƒˆã«æ ¼ç´

å…¨ä½“ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®æ§‹é€ ã¯ã€[Scratch 3.0ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’ä½œã£ã¦ã¿ã‚ˆã†/åŸºæœ¬ã®æ›¸å¼](https://ja.scratch-wiki.info/wiki/Scratch_3.0%E3%81%AE%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86/%E5%9F%BA%E6%9C%AC%E3%81%AE%E6%9B%B8%E5%BC%8F)ã‚’ã€ãƒªã‚¹ãƒˆã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ã¯[Scratch Extensionã‚’ã¤ãã£ã¦ã‚ã‹ã£ãŸã“ã¨](https://qiita.com/yume_yu/items/c7b96fc278771a80a0e5)ã‚’å‚è€ƒã«ä½œæˆã—ã¦ã„ã¾ã™ã€‚

```javascript
const ArgumentType = require('../../extension-support/argument-type');
const BlockType = require('../../extension-support/block-type');
const Cast = require('../../util/cast');
const Variable = require('../../engine/variable');
const prefectureLocations = require('./prefecture-locations');

/**
 * Icon svg to be displayed at the left edge of each extension block, encoded as a data URI.
 * @type {string}
 */
// eslint-disable-next-line max-len
const blockIconURI = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDQwIDQwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zOnNlcmlmPSJodHRwOi8vd3d3LnNlcmlmLmNvbS8iIHN0eWxlPSJmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MjsiPgogICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwtNjEwLC05MCkiPgogICAgICAgIDxnIGlkPSJibG9jay1pY29uIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwwLjk1MjM4MSwwLDMuMzMzMzMpIj4KICAgICAgICAgICAgPHJlY3QgeD0iNjEwIiB5PSI5MSIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQyIiBzdHlsZT0iZmlsbDpub25lOyIvPgogICAgICAgICAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgwLjEwNjkxNiwwLDAsMC4xNDk2ODIsNjA0LjM0LDg1LjA1NzIpIj4KICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KDE5Ljg3MjYsMCwwLDE0LjkwNDUsODEuMDQxNiw1My4zMTIxKSI+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTcsOEM3LDggNyw4IDcsOEM4LjkyLDggMTAuNSw5LjU4IDEwLjUsMTEuNUMxMC41LDExLjUxOCAxMC41LDExLjUzNyAxMC41LDExLjU1NUMxMC41LDExLjU1OCAxMC41LDExLjU2IDEwLjUsMTEuNTYzQzEwLjUsMTEuODM3IDEwLjcyNiwxMi4wNjMgMTEsMTIuMDYzQzExLjA0MiwxMi4wNjMgMTEuMDgzLDEyLjA1NyAxMS4xMjQsMTIuMDQ3QzExLjI0NiwxMi4wMTYgMTEuMzcxLDEyIDExLjQ5NywxMkMxMi4zMiwxMiAxMi45OTgsMTIuNjc3IDEzLDEzLjVDMTMsMTQuMzIzIDEyLjMyMywxNSAxMS41LDE1TDMsMTVDMS45MDcsMTQuOTk0IDEuMDExLDE0LjA5MyAxLjAxMSwxM0MxLjAxMSwxMS45MDMgMS45MTQsMTEgMy4wMTEsMTFDMy4wNDEsMTEgMy4wNywxMS4wMDEgMy4xLDExLjAwMkMzLjMzNywxMS4wMTQgMy41NTEsMTAuODU3IDMuNjEsMTAuNjI3QzQuMDA4LDkuMDg2IDUuNDA4LDggNyw4Wk0xMS40NzMsMTFDMTEuMjIxLDguNzMyIDkuMjgyLDYuOTk2IDcsNi45OTZDNS4wOTMsNi45OTYgMy4zODMsOC4yMDkgMi43NTMsMTAuMDFDMS4yMDUsMTAuMTM3IC0wLjAwMiwxMS40NDYgLTAuMDAyLDEzQy0wLjAwMiwxNC42NDYgMS4zNTIsMTYgMi45OTgsMTZDMi45OTgsMTYgMi45OTksMTYgMywxNkwxMS41LDE2QzEyLjg3MSwxNiAxNCwxNC44NzEgMTQsMTMuNUMxNCwxMi4xMjkgMTIuODcxLDExIDExLjUsMTFMMTEuNDczLDExWiIgc3R5bGU9ImZpbGw6d2hpdGU7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxOS44NzI2LDAsMCwxNC45MDQ1LDgxLjA0MTYsNTMuMzEyMSkiPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC41LDEuNUMxMC41LDEuMjI2IDEwLjI3NCwxIDEwLDFDOS43MjYsMSA5LjUsMS4yMjYgOS41LDEuNUw5LjUsMi41QzkuNSwyLjc3NCA5LjcyNiwzIDEwLDNDMTAuMjc0LDMgMTAuNSwyLjc3NCAxMC41LDIuNUwxMC41LDEuNVpNMTQuMjQzLDMuNDY0QzE0LjM0MSwzLjM3IDE0LjM5NiwzLjI0IDE0LjM5NiwzLjEwNEMxNC4zOTYsMi44MyAxNC4xNywyLjYwNCAxMy44OTYsMi42MDRDMTMuNzYsMi42MDQgMTMuNjMsMi42NTkgMTMuNTM2LDIuNzU3TDEyLjgyOCwzLjQ2NEMxMi43MzQsMy41NTggMTIuNjgxLDMuNjg1IDEyLjY4MSwzLjgxOEMxMi42ODEsNC4wOTMgMTIuOTA3LDQuMzE5IDEzLjE4Miw0LjMxOUMxMy4zMTUsNC4zMTkgMTMuNDQyLDQuMjY2IDEzLjUzNiw0LjE3MkwxNC4yNDMsMy40NjRaTTYuNDY0LDIuNzU3QzYuMzcxLDIuNjY3IDYuMjQ2LDIuNjE3IDYuMTE3LDIuNjE3QzUuODQyLDIuNjE3IDUuNjE3LDIuODQyIDUuNjE3LDMuMTE3QzUuNjE3LDMuMjQ2IDUuNjY3LDMuMzcxIDUuNzU3LDMuNDY0TDYuNDY0LDQuMTcyQzYuNTU4LDQuMjY2IDYuNjg1LDQuMzE5IDYuODE4LDQuMzE5QzcuMDkzLDQuMzE5IDcuMzE5LDQuMDkzIDcuMzE5LDMuODE4QzcuMzE5LDMuNjg1IDcuMjY2LDMuNTU4IDcuMTcyLDMuNDY0TDYuNDY0LDIuNzU3Wk04LjE5OCw2LjEzMUM4LjUzMSw1LjQ0MSA5LjIzMyw1IDkuOTk5LDVDMTEuMDk2LDUgMTEuOTk5LDUuOTAzIDExLjk5OSw3QzExLjk5OSw3LjQ5IDExLjgxOSw3Ljk2MyAxMS40OTQsOC4zMjlDMTEuNjkzLDguNjEgMTEuODY2LDguOTExIDEyLjAxLDkuMjI3QzEyLjYzOSw4LjY1OCAxMi45OTksNy44NDkgMTIuOTk5LDcuMDAxQzEyLjk5OSw1LjM1NSAxMS42NDUsNC4wMDEgOS45OTksNC4wMDFDOC43Myw0LjAwMSA3LjU5Miw0LjgwNiA3LjE3LDYuMDAyQzcuNTIyLDYuMDEzIDcuODY2LDYuMDU3IDguMTk4LDYuMTMxWk0xMi42ODIsMTAuMjA1QzEzLjI4MiwxMC40MiAxMy44MDcsMTAuNzk1IDE0LjIwNCwxMS4yNzdDMTQuMzIxLDExLjE4MiAxNC4zODksMTEuMDM5IDE0LjM4OSwxMC44ODhDMTQuMzg5LDEwLjc1NiAxNC4zMzcsMTAuNjI5IDE0LjI0MywxMC41MzVMMTMuNTM2LDkuODI4QzEzLjQ0Miw5LjczNCAxMy4zMTQsOS42ODEgMTMuMTgxLDkuNjgxQzEyLjkwNyw5LjY4MSAxMi42ODEsOS45MDYgMTIuNjgxLDEwLjE4MUMxMi42ODEsMTAuMTg5IDEyLjY4MiwxMC4xOTcgMTIuNjgyLDEwLjIwNVpNMTQuNSw2LjVDMTQuMjI2LDYuNSAxNCw2LjcyNiAxNCw3QzE0LDcuMjc0IDE0LjIyNiw3LjUgMTQuNSw3LjVMMTUuNSw3LjVDMTUuNzc0LDcuNSAxNiw3LjI3NCAxNiw3QzE2LDYuNzI2IDE1Ljc3NCw2LjUgMTUuNSw2LjVMMTQuNSw2LjVaIiBzdHlsZT0iZmlsbDp3aGl0ZTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg==';

/**
 * Icon svg to be displayed in the category menu, encoded as a data URI.
 * @type {string}
 */
// eslint-disable-next-line max-len
const menuIconURI = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDQwIDQwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zOnNlcmlmPSJodHRwOi8vd3d3LnNlcmlmLmNvbS8iIHN0eWxlPSJmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MjsiPgogICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwtNjEwLC0xNDApIj4KICAgICAgICA8ZyBpZD0ibWVudS1pY29uIiB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwwLjk1MjM4MSwwLDUzLjMzMzMpIj4KICAgICAgICAgICAgPHJlY3QgeD0iNjEwIiB5PSI5MSIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQyIiBzdHlsZT0iZmlsbDpub25lOyIvPgogICAgICAgICAgICA8Y2xpcFBhdGggaWQ9Il9jbGlwMSI+CiAgICAgICAgICAgICAgICA8cmVjdCB4PSI2MTAiIHk9IjkxIiB3aWR0aD0iNDAiIGhlaWdodD0iNDIiLz4KICAgICAgICAgICAgPC9jbGlwUGF0aD4KICAgICAgICAgICAgPGcgY2xpcC1wYXRoPSJ1cmwoI19jbGlwMSkiPgogICAgICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMS4wNSwwLC01NikiPgogICAgICAgICAgICAgICAgICAgIDxjaXJjbGUgY3g9IjYzMCIgY3k9IjE2MCIgcj0iMjAiIHN0eWxlPSJmaWxsOnJnYigwLDE5NSwyNTUpOyIvPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMC4xMzQxODgsMCwwLDAuMTg3ODYzLDU5Mi4wODIsODMuMTA0NikiPgogICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KDE5Ljg3MjYsMCwwLDE0LjkwNDUsODEuMDQxNiw1My4zMTIxKSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik03LDhDNyw4IDcsOCA3LDhDOC45Miw4IDEwLjUsOS41OCAxMC41LDExLjVDMTAuNSwxMS41MTggMTAuNSwxMS41MzcgMTAuNSwxMS41NTVDMTAuNSwxMS41NTggMTAuNSwxMS41NiAxMC41LDExLjU2M0MxMC41LDExLjgzNyAxMC43MjYsMTIuMDYzIDExLDEyLjA2M0MxMS4wNDIsMTIuMDYzIDExLjA4MywxMi4wNTcgMTEuMTI0LDEyLjA0N0MxMS4yNDYsMTIuMDE2IDExLjM3MSwxMiAxMS40OTcsMTJDMTIuMzIsMTIgMTIuOTk4LDEyLjY3NyAxMywxMy41QzEzLDE0LjMyMyAxMi4zMjMsMTUgMTEuNSwxNUwzLDE1QzEuOTA3LDE0Ljk5NCAxLjAxMSwxNC4wOTMgMS4wMTEsMTNDMS4wMTEsMTEuOTAzIDEuOTE0LDExIDMuMDExLDExQzMuMDQxLDExIDMuMDcsMTEuMDAxIDMuMSwxMS4wMDJDMy4zMzcsMTEuMDE0IDMuNTUxLDEwLjg1NyAzLjYxLDEwLjYyN0M0LjAwOCw5LjA4NiA1LjQwOCw4IDcsOFpNMTEuNDczLDExQzExLjIyMSw4LjczMiA5LjI4Miw2Ljk5NiA3LDYuOTk2QzUuMDkzLDYuOTk2IDMuMzgzLDguMjA5IDIuNzUzLDEwLjAxQzEuMjA1LDEwLjEzNyAtMC4wMDIsMTEuNDQ2IC0wLjAwMiwxM0MtMC4wMDIsMTQuNjQ2IDEuMzUyLDE2IDIuOTk4LDE2QzIuOTk4LDE2IDIuOTk5LDE2IDMsMTZMMTEuNSwxNkMxMi44NzEsMTYgMTQsMTQuODcxIDE0LDEzLjVDMTQsMTIuMTI5IDEyLjg3MSwxMSAxMS41LDExTDExLjQ3MywxMVoiIHN0eWxlPSJmaWxsOndoaXRlO2ZpbGwtcnVsZTpub256ZXJvOyIvPgogICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxOS44NzI2LDAsMCwxNC45MDQ1LDgxLjA0MTYsNTMuMzEyMSkiPgogICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTAuNSwxLjVDMTAuNSwxLjIyNiAxMC4yNzQsMSAxMCwxQzkuNzI2LDEgOS41LDEuMjI2IDkuNSwxLjVMOS41LDIuNUM5LjUsMi43NzQgOS43MjYsMyAxMCwzQzEwLjI3NCwzIDEwLjUsMi43NzQgMTAuNSwyLjVMMTAuNSwxLjVaTTE0LjI0MywzLjQ2NEMxNC4zNDEsMy4zNyAxNC4zOTYsMy4yNCAxNC4zOTYsMy4xMDRDMTQuMzk2LDIuODMgMTQuMTcsMi42MDQgMTMuODk2LDIuNjA0QzEzLjc2LDIuNjA0IDEzLjYzLDIuNjU5IDEzLjUzNiwyLjc1N0wxMi44MjgsMy40NjRDMTIuNzM0LDMuNTU4IDEyLjY4MSwzLjY4NSAxMi42ODEsMy44MThDMTIuNjgxLDQuMDkzIDEyLjkwNyw0LjMxOSAxMy4xODIsNC4zMTlDMTMuMzE1LDQuMzE5IDEzLjQ0Miw0LjI2NiAxMy41MzYsNC4xNzJMMTQuMjQzLDMuNDY0Wk02LjQ2NCwyLjc1N0M2LjM3MSwyLjY2NyA2LjI0NiwyLjYxNyA2LjExNywyLjYxN0M1Ljg0MiwyLjYxNyA1LjYxNywyLjg0MiA1LjYxNywzLjExN0M1LjYxNywzLjI0NiA1LjY2NywzLjM3MSA1Ljc1NywzLjQ2NEw2LjQ2NCw0LjE3MkM2LjU1OCw0LjI2NiA2LjY4NSw0LjMxOSA2LjgxOCw0LjMxOUM3LjA5Myw0LjMxOSA3LjMxOSw0LjA5MyA3LjMxOSwzLjgxOEM3LjMxOSwzLjY4NSA3LjI2NiwzLjU1OCA3LjE3MiwzLjQ2NEw2LjQ2NCwyLjc1N1pNOC4xOTgsNi4xMzFDOC41MzEsNS40NDEgOS4yMzMsNSA5Ljk5OSw1QzExLjA5Niw1IDExLjk5OSw1LjkwMyAxMS45OTksN0MxMS45OTksNy40OSAxMS44MTksNy45NjMgMTEuNDk0LDguMzI5QzExLjY5Myw4LjYxIDExLjg2Niw4LjkxMSAxMi4wMSw5LjIyN0MxMi42MzksOC42NTggMTIuOTk5LDcuODQ5IDEyLjk5OSw3LjAwMUMxMi45OTksNS4zNTUgMTEuNjQ1LDQuMDAxIDkuOTk5LDQuMDAxQzguNzMsNC4wMDEgNy41OTIsNC44MDYgNy4xNyw2LjAwMkM3LjUyMiw2LjAxMyA3Ljg2Niw2LjA1NyA4LjE5OCw2LjEzMVpNMTIuNjgyLDEwLjIwNUMxMy4yODIsMTAuNDIgMTMuODA3LDEwLjc5NSAxNC4yMDQsMTEuMjc3QzE0LjMyMSwxMS4xODIgMTQuMzg5LDExLjAzOSAxNC4zODksMTAuODg4QzE0LjM4OSwxMC43NTYgMTQuMzM3LDEwLjYyOSAxNC4yNDMsMTAuNTM1TDEzLjUzNiw5LjgyOEMxMy40NDIsOS43MzQgMTMuMzE0LDkuNjgxIDEzLjE4MSw5LjY4MUMxMi45MDcsOS42ODEgMTIuNjgxLDkuOTA2IDEyLjY4MSwxMC4xODFDMTIuNjgxLDEwLjE4OSAxMi42ODIsMTAuMTk3IDEyLjY4MiwxMC4yMDVaTTE0LjUsNi41QzE0LjIyNiw2LjUgMTQsNi43MjYgMTQsN0MxNCw3LjI3NCAxNC4yMjYsNy41IDE0LjUsNy41TDE1LjUsNy41QzE1Ljc3NCw3LjUgMTYsNy4yNzQgMTYsN0MxNiw2LjcyNiAxNS43NzQsNi41IDE1LjUsNi41TDE0LjUsNi41WiIgc3R5bGU9ImZpbGw6d2hpdGU7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4K';

/**
 * Class for the new blocks in Scratch 3.0
 * @param {Runtime} runtime - the runtime instantiating this block package.
 * @constructor
 */
class Scratch3OpenMeteoBlocks {
    constructor (runtime) {
        /**
         * The runtime instantiating this block package.
         * @type {Runtime}
         */
        this.runtime = runtime;
    }

    getWeatherDescription (code = -1) {
        switch (code) {
        case 0: return 'å¿«æ™´';
        case 1: return 'æ™´ã‚Œ';
        case 2: return 'æ™´ã‚Œæ™‚ã€…æ›‡ã‚Š';
        case 3: return 'æ›‡ã‚Š';
        case 45: return 'éœ§';
        case 48: return 'éœ§';
        case 51: return 'å¼±ã„éœ§é›¨';
        case 53: return 'éœ§é›¨';
        case 55: return 'å¼·ã„éœ§é›¨';
        case 56: return 'å¯’ã„éœ§é›¨';
        case 57: return 'å‡ãˆã‚‹éœ§é›¨';
        case 61: return 'å°é›¨';
        case 63: return 'é›¨';
        case 65: return 'è±ªé›¨';
        case 66: return 'å¯’ã„é›¨';
        case 67: return 'å‡ãˆã‚‹é›¨';
        case 71: return 'å¼±ã„é›ª';
        case 73: return 'é›ª';
        case 75: return 'å¼·ã„é›ª';
        case 77: return 'éœ§é›ª';
        case 80: return 'å¼±ã„ã«ã‚ã‹é›¨';
        case 81: return 'ã«ã‚ã‹é›¨';
        case 82: return 'å¼·ã„ã«ã‚ã‹é›¨';
        case 85: return 'å¼±ã„ã«ã‚ã‹é›ª';
        case 86: return 'å¼·ã„ã«ã‚ã‹é›ª';
        case 95: return 'é›·é›¨';
        case 96: return 'é›·é›¨';
        case 99: return 'å¼·ã„é›·é›¨';
        default: return 'ä¸æ˜';
        }
    }

    /**
     * @returns {object} metadata for this extension and its blocks.
     */
    getInfo () {
        return {
            id: 'openMeteo',
            name: 'å¤©æ°—',
            menuIconURI: menuIconURI,
            blockIconURI: blockIconURI,
            blocks: [
                {
                    opcode: 'listWeather',
                    text: 'å¤©æ°—äºˆå ±ã®æ—¥ä»˜ã‚’[DATE_LIST]ã«ã€å¤©æ°—ã‚’[WEATHER_LIST]ã«æ ¼ç´ã™ã‚‹',
                    blockType: BlockType.COMMAND,
                    arguments: {
                        DATE_LIST: {
                            type: ArgumentType.STRING,
                            defaultValue: 'ãƒªã‚¹ãƒˆå'
                        },
                        WEATHER_LIST: {
                            type: ArgumentType.STRING,
                            defaultValue: 'ãƒªã‚¹ãƒˆå'
                        }
                    }
                },
                {
                    opcode: 'listPrefectureWeather',
                    text: '[PREFECTURE]ã®å¤©æ°—äºˆå ±ã®æ—¥ä»˜ã‚’[DATE_LIST]ã«ã€å¤©æ°—ã‚’[WEATHER_LIST]ã«æ ¼ç´ã™ã‚‹',
                    blockType: BlockType.COMMAND,
                    arguments: {
                        PREFECTURE: {
                            type: ArgumentType.NUMBER,
                            menu: 'prefectureMenu',
                            defaultValue: 0
                        },
                        DATE_LIST: {
                            type: ArgumentType.STRING,
                            defaultValue: 'ãƒªã‚¹ãƒˆå'
                        },
                        WEATHER_LIST: {
                            type: ArgumentType.STRING,
                            defaultValue: 'ãƒªã‚¹ãƒˆå'
                        }
                    }
                },
                {
                    opcode: 'getWeather',
                    text: '[OFFSET]æ—¥å¾Œã®å¤©æ°—ã‚’å–å¾—',
                    blockType: BlockType.REPORTER,
                    arguments: {
                        OFFSET: {
                            type: ArgumentType.NUMBER,
                            defaultValue: 1
                        }
                    }
                },
                {
                    opcode: 'getPrefectureWeather',
                    text: '[PREFECTURE]ã®[OFFSET]æ—¥å¾Œã®å¤©æ°—ã‚’å–å¾—',
                    blockType: BlockType.REPORTER,
                    arguments: {
                        PREFECTURE: {
                            type: ArgumentType.NUMBER,
                            menu: 'prefectureMenu',
                            defaultValue: 0
                        },
                        OFFSET: {
                            type: ArgumentType.NUMBER,
                            defaultValue: 1
                        }
                    }
                }
            ],
            menus: {
                prefectureMenu: {
                    acceptReporters: true,
                    items: prefectureLocations.map((loc, index) => ({
                        text: loc.prefecture,
                        value: index
                    }))
                }
            }
        };
    }

    async fetchWeather (latitude, longitude) {
        const prefix = 'https://api.open-meteo.com/v1/forecast?';
        const suffix = '&daily=weathercode&timezone=Asia%2FTokyo';

        const url = `${prefix}latitude=${latitude}&longitude=${longitude}${suffix}`;
        const res = await fetch(url);
        const result = await res.json();

        return result.daily;
    }

    async getPointWeather (latitude, longitude, offset) {
        const res = await this.fetchWeather(latitude, longitude);
        const weathercodes = res.weathercode;

        if (offset >= 0 && offset < weathercodes.length) {
            return this.getWeatherDescription(weathercodes[offset]);
        }
        return this.getWeatherDescription();
    }

    async getCurrentLocationWether (offset) {
        const position = await new Promise((resolve, reject) =>
            navigator.geolocation.getCurrentPosition(resolve, reject));
        return await this.getPointWeather(position.coords.latitude, position.coords.longitude, offset);
    }

    setList (list, array) {
        list.value = array;
        list._monitorUpToDate = false;
    }

    // æŒ‡å®šã—ãŸçœŒã®æ—¥ä»˜æŒ‡å®šã®å¤©æ°—ã‚’å–å¾—
    getPrefectureWeather (args) {
        const index = Cast.toNumber(args.PREFECTURE);
        const loc = prefectureLocations[index];
        return this.getPointWeather(loc.latitude, loc.longitude, Cast.toNumber(args.OFFSET));
    }


    // ç¾åœ¨åœ°ã®æ—¥ä»˜æŒ‡å®šã®å¤©æ°—ã‚’å–å¾—
    getWeather (args) {
        return this.getCurrentLocationWether(Cast.toNumber(args.OFFSET));
    }

    // æŒ‡å®šã—ãŸçœŒã®ä¸€é€±é–“åˆ†ã®å¤©æ°—ã‚’å–å¾—
    async listPrefectureWeather (args, util) {
        const dateListName = Cast.toString(args.DATE_LIST);
        const weatherListName = Cast.toString(args.WEATHER_LIST);

        const dateList = util.target.lookupVariableByNameAndType(dateListName, Variable.LIST_TYPE);
        const weatherList = util.target.lookupVariableByNameAndType(weatherListName, Variable.LIST_TYPE);

        let res;
        if (dateList || weatherList) {
            const index = Cast.toNumber(args.PREFECTURE);
            const loc = prefectureLocations[index];
            res = await this.fetchWeather(loc.latitude, loc.longitude);
        }

        if (dateList) this.setList(dateList, res.time);
        if (weatherList) this.setList(weatherList, res.weathercode.map(wc => this.getWeatherDescription(wc)));
    }


    // ç¾åœ¨åœ°ã®ä¸€é€±é–“åˆ†ã®å¤©æ°—ã‚’å–å¾—
    async listWeather (args, util) {
        const dateListName = Cast.toString(args.DATE_LIST);
        const weatherListName = Cast.toString(args.WEATHER_LIST);

        const dateList = util.target.lookupVariableByNameAndType(dateListName, Variable.LIST_TYPE);
        const weatherList = util.target.lookupVariableByNameAndType(weatherListName, Variable.LIST_TYPE);

        let res;
        if (dateList || weatherList) {
            const position = await new Promise((resolve, reject) =>
                navigator.geolocation.getCurrentPosition(resolve, reject));
            res = await this.fetchWeather(position.coords.latitude, position.coords.longitude);
        }

        if (dateList) this.setList(dateList, res.time);
        if (weatherList) this.setList(weatherList, res.weathercode.map(wc => this.getWeatherDescription(wc)));
    }
}

module.exports = Scratch3OpenMeteoBlocks;
```

#### prefecture-locations.js

éƒ½é“åºœçœŒã®ç·¯åº¦ã€çµŒåº¦ãƒ‡ãƒ¼ã‚¿ã«ãªã‚Šã¾ã™ã€‚[ã‚„ã˜ã‚ã¹ãˆ](https://techtech-sorae.com/jp_city_latlon/)ã•ã‚“ã®ã‚µã‚¤ãƒˆã®csvãƒ‡ãƒ¼ã‚¿ã‚’jsonã«å¤‰æ›ã—ã¦å–ã‚Šè¾¼ã¿ã¾ã—ãŸã€‚

```javascript
const prefectureLocations = [
    {
        prefecture: 'åŒ—æµ·é“',
        latitude: 43.064359,
        longitude: 141.347449
    },
    {
        prefecture: 'é’æ£®çœŒ',
        latitude: 40.824294,
        longitude: 140.74005
    },
    {
        prefecture: 'å²©æ‰‹çœŒ',
        latitude: 39.70353,
        longitude: 141.152667
    },
    {
        prefecture: 'å®®åŸçœŒ',
        latitude: '38.268737',
        longitude: '140.872183'
    },
    {
        prefecture: 'ç§‹ç”°çœŒ',
        latitude: 39.718175,
        longitude: 140.103356
    },
    {
        prefecture: 'å±±å½¢çœŒ',
        latitude: 38.240127,
        longitude: 140.362533
    },
    {
        prefecture: 'ç¦å³¶çœŒ',
        latitude: 37.750146,
        longitude: 140.466754
    },
    {
        prefecture: 'èŒ¨åŸçœŒ',
        latitude: 36.341817,
        longitude: 140.446796
    },
    {
        prefecture: 'æ ƒæœ¨çœŒ',
        latitude: 36.56575,
        longitude: 139.883526
    },
    {
        prefecture: 'ç¾¤é¦¬çœŒ',
        latitude: 36.391205,
        longitude: 139.060917
    },
    {
        prefecture: 'åŸ¼ç‰çœŒ',
        latitude: 35.857771,
        longitude: 139.647804
    },
    {
        prefecture: 'åƒè‘‰çœŒ',
        latitude: 35.604563,
        longitude: 140.123179
    },
    {
        prefecture: 'æ±äº¬éƒ½',
        latitude: 35.689185,
        longitude: 139.691648
    },
    {
        prefecture: 'ç¥å¥ˆå·çœŒ',
        latitude: 35.447505,
        longitude: 139.642347
    },
    {
        prefecture: 'æ–°æ½ŸçœŒ',
        latitude: 37.901699,
        longitude: 139.022728
    },
    {
        prefecture: 'å¯Œå±±çœŒ',
        latitude: 36.695274,
        longitude: 137.211302
    },
    {
        prefecture: 'çŸ³å·çœŒ',
        latitude: 36.594729,
        longitude: 136.62555
    },
    {
        prefecture: 'ç¦äº•çœŒ',
        latitude: 36.06522,
        longitude: 136.221641
    },
    {
        prefecture: 'å±±æ¢¨çœŒ',
        latitude: 35.665102,
        longitude: 138.568985
    },
    {
        prefecture: 'é•·é‡çœŒ',
        latitude: 36.651282,
        longitude: 138.180972
    },
    {
        prefecture: 'å²é˜œçœŒ',
        latitude: 35.39116,
        longitude: 136.722204
    },
    {
        prefecture: 'é™å²¡çœŒ',
        latitude: 34.976987,
        longitude: 138.383057
    },
    {
        prefecture: 'æ„›çŸ¥çœŒ',
        latitude: 35.180247,
        longitude: 136.906698
    },
    {
        prefecture: 'ä¸‰é‡çœŒ',
        latitude: 34.730547,
        longitude: 136.50861
    },
    {
        prefecture: 'æ»‹è³€çœŒ',
        latitude: 35.004532,
        longitude: 135.868588
    },
    {
        prefecture: 'äº¬éƒ½çœŒ',
        latitude: 35.0209962,
        longitude: 135.7531135
    },
    {
        prefecture: 'å¤§é˜ªåºœ',
        latitude: 34.686492,
        longitude: 135.518992
    },
    {
        prefecture: 'å…µåº«çœŒ',
        latitude: 34.69128,
        longitude: 135.183087
    },
    {
        prefecture: 'å¥ˆè‰¯çœŒ',
        latitude: 34.685296,
        longitude: 135.832745
    },
    {
        prefecture: 'å’Œæ­Œå±±çœŒ',
        latitude: 34.224806,
        longitude: 135.16795
    },
    {
        prefecture: 'é³¥å–çœŒ',
        latitude: 35.503463,
        longitude: 134.238258
    },
    {
        prefecture: 'å³¶æ ¹çœŒ',
        latitude: 35.472248,
        longitude: 133.05083
    },
    {
        prefecture: 'å²¡å±±çœŒ',
        latitude: 34.66132,
        longitude: 133.934414
    },
    {
        prefecture: 'åºƒå³¶çœŒ',
        latitude: 34.396033,
        longitude: 132.459595
    },
    {
        prefecture: 'å±±å£çœŒ',
        latitude: 34.185648,
        longitude: 131.470755
    },
    {
        prefecture: 'å¾³å³¶çœŒ',
        latitude: '34.065732',
        longitude: '134.559293'
    },
    {
        prefecture: 'é¦™å·çœŒ',
        latitude: 34.34014,
        longitude: 134.04297
    },
    {
        prefecture: 'æ„›åª›çœŒ',
        latitude: 33.841649,
        longitude: 132.76585
    },
    {
        prefecture: 'é«˜çŸ¥çœŒ',
        latitude: 33.55969,
        longitude: 133.530887
    },
    {
        prefecture: 'ç¦å²¡çœŒ',
        latitude: 33.606767,
        longitude: 130.418228
    },
    {
        prefecture: 'ä½è³€çœŒ',
        latitude: 33.249367,
        longitude: 130.298822
    },
    {
        prefecture: 'é•·å´çœŒ',
        latitude: 32.744542,
        longitude: 129.873037
    },
    {
        prefecture: 'ç†Šæœ¬çœŒ',
        latitude: 32.790385,
        longitude: 130.742345
    },
    {
        prefecture: 'å¤§åˆ†çœŒ',
        latitude: 33.2382,
        longitude: 131.612674
    },
    {
        prefecture: 'å®®å´çœŒ',
        latitude: 31.91109,
        longitude: 131.423855
    },
    {
        prefecture: 'é¹¿å…å³¶çœŒ',
        latitude: 31.560219,
        longitude: 130.557906
    },
    {
        prefecture: 'æ²–ç¸„çœŒ',
        latitude: 26.211538,
        longitude: 127.681115
    }
];

module.exports = prefectureLocations;
```

### ãƒ†ã‚¹ãƒˆ

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œå¾Œã€`http://localhost:8601`ã«ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ãŠé¦´æŸ“ã¿ã®Scratchã®ã‚µã‚¤ãƒˆã‹ã‚‰æ‹¡å¼µæ©Ÿèƒ½ã‚’ç¢ºèªã§ãã¾ã™ã€‚ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«åæ˜ ã•ã‚Œã¾ã™ã®ã§åŠ¹ç‡çš„ã«ãƒ‡ãƒãƒƒã‚°ã§ãã¾ã™ã€‚

```bash
cd ../scratch-gui
yarn start
```

### GitHub Pagesã§ã®å…¬é–‹

ä»¥ä¸Šã®scratch-vm, scratch-guiã®å¤‰æ›´ã‚’GitHubã«pushã—ã¾ã™ã€‚GitHubã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ–ãƒ©ãƒ³ãƒã¯developã«ãªã£ã¦ã„ã¾ã™ãŒã€æ–°ã—ã„ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã—ã¦ã€ãã¡ã‚‰ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ–ãƒ©ãƒ³ãƒã«è¨­å®šã—ã¦é–‹ç™ºã‚’é€²ã‚ã‚‹ã®ãŒã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ï¼ˆdevelopãƒ–ãƒ©ãƒ³ãƒã¯æœ¬å®¶ã®scratch-vm, scratch-guiã®å¤‰æ›´ãŒåæ˜ ã•ã‚Œã¦ã„ãã¾ã™ã®ã§ï¼‰ã€‚

ã“ã“ã¾ã§ã§ãã‚Œã°ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ä½œæˆã—ãŸæ‹¡å¼µæ©Ÿèƒ½ã‚’GitHub Pagesã«å…¬é–‹ã—ã¾ã—ã‚‡ã†ã€‚

```bash
cd ../scratch-vm
npm i
npm run build # å¿µã®ãŸã‚scratch-vmå´ã‚‚build
cd ../scratch-gui
npm run build
npm run deploy
```

ä¸Šè¨˜ã§ã€`https://[GitHubã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ].github.io/scratch-gui/`ã«æ‹¡å¼µæ©Ÿèƒ½ä»˜ãã®ScratchãŒå…¬é–‹ã•ã‚Œã¾ã™ã€‚

## ãŠã‚ã‚Šã«

æ—¢ã«å¤šãã®æ–¹ã€…ãŒScratchã®æ‹¡å¼µã«æŒ‘æˆ¦ã—ã¦ã„ã¾ã™ã®ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã«å¤šãã®æœ‰ç›Šãªæƒ…å ±ãŒã‚ã‚Šå¤§å¤‰åŠ©ã‹ã‚Šã¾ã—ãŸï¼ä»Šå›ã¯ç›´æ¥Scratchã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒ•ã‚©ãƒ¼ã‚¯ã—ã¦æ‹¡å¼µã—ã¾ã—ãŸãŒã€[Xcratch](https://github.com/xcratch/)ã®ã‚ˆã†ã«æ‹¡å¼µæ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸScratchã‚‚å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚ã‚‹ç¨‹åº¦æ‹¡å¼µã®ã‚„ã‚Šæ–¹ãŒã‚ã‹ã£ã¦ããŸã‚‰Xcratchã«ã‚‚æŒ‘æˆ¦ã—ãŸã„ã¨æ€ã„ã¾ã™ï¼
