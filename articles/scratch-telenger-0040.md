---
title: "Scratchでオリジナルキャラクターを動かそう！ (4) 戦場はオフィス"
emoji: "🧑‍💻"
type: "tech"
topics: ["scratch", "CoderDojo", "animation"]
published: false
---

## はじめに

[CoderDojo](https://coderdojo.jp/)というボランティア団体で、子供達のプログラミングスキル習得の支援をしております。プログラミングの開発環境は、主に[Scratch]((https://scratch.mit.edu))を使っていますが、チュートリアルの次のレベルの教材を充実させたいと感じており、本シリーズの執筆を開始しました。

今回はオリジナルキャラクター「デジタル戦隊テレんじゃー」の「テレッド」がオフィスを縦横無尽に駆け巡ります！

## 戦場はオフィス

今回はテレッドが横スクロールでオフィスを動き回るところまでを目指します。今回の成果物は以下になります。背景が動くとだいぶゲームらしくなってきますね。今回の教材ではScratchの以下の機能を活用しています；

1. **メッセージを送る**: テレッドが移動したときに背景をスクロールさせるのに使用します。
2. **クローン**: 背景の横長の画像を生成するのに使用します。
3. **このスプライトのみの変数**: クローンした背景画像に番号を付与して、画像の位置を保存するのに使用します。

### Scratchのサイト

**[戦場はオフィス](https://scratch.mit.edu/projects/733678294)**

https://youtu.be/pguDH9V9YnQ

## 背景の横スクロールのやり方

Scratchでは背景は通常はステージで設定しますが、残念ながらステージで設定する背景は位置指定ができません。画面より大きな画像を指定して横スクロールする、といったことができません。

このため横スクロールを実現するためには、背景用のスプライトを作成して横移動させるというやり方になります。今回はスプライトの中に５つのコスチュームを作成し、それらを横に並べて順次表示することで横スクロールを実現します。

![全体構成](/images/scratch-telenger-0040/scrolling-01-structure.png)

画面で表示されるエリアをカメラのフレームと考えて、背景画像の一部を切り出して表示する、というイメージになります。おおまかな処理の流れは以下になります；

- 各々の背景に**背景横位置**変数を設定するとともに、カメラのフレームが背景のどの部分を表示しているかを**画面横位置**変数で管理
- **背景横位置 ー 画面横位置**で背景スプライトの画面上の位置を計算し、カメラのフレーム内に入っている場合は「表示する」ブロックで画面表示
- 上記の計算でフレーム外の場合は「隠す」ブロックで背景スプライトを隠す

テレッドの動きに合わせて**画面横位置**を変更することで、背景も横スクロールします。

## 背景の作成

それでは背景素材から作っていきましょう。今回もAffinity Designerを使って作ってみました。背景素材は幅480px, 高さ360pxで作成することで画面ピッタリに収まります。作り方はテレッドの素材を作った時とやり方は同じですので割愛しますが、svgファイルの`width="100%" height="100%"`を削除するのを忘れずに実施して下さい。

[ここからsvgファイルをダウンロード](https://github.com/naoji3x/zenn/tree/main/assets/scratch/tel-red/svg)してご利用いただくことも可能です。Affinity Designerのファイルは[こちら](https://github.com/naoji3x/zenn/tree/main/assets/scratch/tel-red/svg)、一括の[圧縮ファイルはこちら](https://github.com/naoji3x/zenn/blob/main/assets/scratch/tel-red/svg/tel-red-svg-files.zip)になります。

背景画像をコスチュームとして読み込み、コスチューム名を**背景1,背景2,背景3,背景4,背景5**に変更ください。なお1,2,3,4,5の**数値は半角**にして下さい（後のコードの中で使います）。また、読み込んだ画像のパーツを全選択してグループ化して下さい（グループ化しないと画面に表示されませんでした）。

![背景画像](/images/scratch-telenger-0040/scrolling-01-costumes.png)

## 背景の配置

## テレッドの動きに合わせて背景を横スクロールさせる

## 左右の非表示エリアの設定

## おわりに


